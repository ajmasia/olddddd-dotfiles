#!/usr/bin/env bash

# Initialize bspw monitora& desktops
laptop_screen_state=$(cat /proc/acpi/button/lid/LID1/state | awk '{print $2}')
is_external_monitor_connected=$(xrandr --query | grep 'HDMI-1 connected' | awk '{print $1 " " $2}')

# for monitor in $(bspc query -M); do
# 	bspc monitor $monitor -r
# done

logger bspwm $laptop_screen_state
logger bspwm $is_external_monitor_connected

if [[ $is_external_monitor_connected != "HDMI-1 connected" && $laptop_screen_state == "open" ]]; then
	bspc monitor eDP-1 -d I II III IV V VI VII VIII
	# bspc desktop I -l monocle
	bspc monitor HDMI-1 -r
	notify-send "Monitors" "Laptop mode"

	exit 0
elif [[ $is_external_monitor_connected == "HDMI-1 connected" && $laptop_screen_state == "open" ]]; then
	bspc monitor eDP-1 -d I II
	bspc monitor HDMI-1 -f -d III IV V VI VII VIII IX X
	bspc desktop I -l monocle
	notify-send "Monitors" "Slimbook screen and Dell monitor connected"

	exit 0
else
	bspc monitor HDMI-1 -d I II III IV V VI VII VIII
	bspc monitor eDP-1 -r
	notify-send "Monitors" "Dell monitor connected"
	# bspc desktop I -l monocle
fi
